<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Socket.io Chat Example</title>
    <link rel="stylesheet" href="./css/style.css" type="">
</head>

<body>
    <div class="page-header">
        <h3>경쟁전입니다.</h3>
    </div>
    <div class="page-body">
        <div class="room-info">
            <h1>테스트 게임방</h1>
        </div>
        <div class="timer">
            남은 시간 : 0 초
        </div>
        <div class="notice">
            공지사항입니다.
        </div>
        <div class="quiz">
            <h1>퀴즈 1 : 1 + 1 = ?</h1>
        </div>
        <div class="answer">
            <form action="">
                <input class="user-answer" type="button" value="1">
                <input class="user-answer" type="button" value="2">
                <input class="user-answer" type="button" value="3">
                <input class="user-answer" type="button" value="4">
            </form>
        </div>
        <div class="chat">
            <div id="chatLogs"></div>
        </div>
    </div>
    <form class="form-inline">
        <div class="form-group">
            <label for="msgForm">Message: </label>
            <input type="text" class="form-control" id="msgForm">
        </div>
        <button type="submit" class="btn btn-primary">Send</button>
    </form>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        $(function () {
            // socket.io 서버에 접속한다
            var socket = io();

            // 서버로 자신의 정보를 전송한다.
            socket.emit("login", {
                // name: "ungmo2",
                name: "userName",
                userid: "userId"
            });

            // 서버로부터의 메시지가 수신되면
            socket.on("login", function (data) {
                $("#chatLogs").append("<div><strong>" + data + "</strong>님이 참가하셨습니다.</div>");
            });

            // 서버로부터의 메시지가 수신되면
            socket.on("answer", function (data) {
                $("#chatLogs").append("<div><strong>" + data.from.name + "</strong> : " + data.answer + "</div>");
            });

            // 답변 버튼이 클릭되면
            $(".user-answer").click(function (e) {
                e.preventDefault();
                var $answer = $(this);
                console.log($answer.val());

                // 서버로 메시지를 전송한다.
                socket.emit("quiz", { answer: $answer.val() });
            });

            // 서버로부터의 메시지가 수신되면
            socket.on("chat", function (data) {
                $("#chatLogs").append("<div><strong>" + data.from.name + "</strong> : " + data.msg + "</div>");
            });

            // Send 버튼이 클릭되면
            $("form").submit(function (e) {
                e.preventDefault();
                var $msgForm = $("#msgForm");

                // 서버로 메시지를 전송한다.
                socket.emit("chat", { msg: $msgForm.val() });
                $msgForm.val("");
            });
        });
    </script>
</body>

</html>